// Generate minimal test PNG and text file for E2E tests
import { writeFileSync } from 'fs'
import { join, dirname } from 'path'
import { fileURLToPath } from 'url'

const __dirname = dirname(fileURLToPath(import.meta.url))

// Minimal valid 1x1 red PNG (67 bytes)
const PNG_HEADER = Buffer.from([
  0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a, // PNG signature
  0x00, 0x00, 0x00, 0x0d, // IHDR length
  0x49, 0x48, 0x44, 0x52, // IHDR
  0x00, 0x00, 0x00, 0x01, // width: 1
  0x00, 0x00, 0x00, 0x01, // height: 1
  0x08, 0x02,             // bit depth: 8, color type: RGB
  0x00, 0x00, 0x00,       // compression, filter, interlace
  0x90, 0x77, 0x53, 0xde, // CRC
  0x00, 0x00, 0x00, 0x0c, // IDAT length
  0x49, 0x44, 0x41, 0x54, // IDAT
  0x08, 0xd7, 0x63, 0xf8, 0xcf, 0xc0, 0x00, 0x00,
  0x01, 0x01, 0x01, 0x00, // compressed data
  0x18, 0xdd, 0x8d, 0xb4, // CRC
  0x00, 0x00, 0x00, 0x00, // IEND length
  0x49, 0x45, 0x4e, 0x44, // IEND
  0xae, 0x42, 0x60, 0x82, // CRC
])

writeFileSync(join(__dirname, 'fixtures', 'test.png'), PNG_HEADER)
writeFileSync(join(__dirname, 'fixtures', 'test.txt'), 'not an image')
console.log('Test fixtures generated.')
